{"openapi":"3.0.0","info":{"title":"Roomi Auth","description":"Authentication and user management API for Roomi AI","version":"1.0.0","x-aws-sigv4-info":"AWS SigV4 Authentication: Requests must include Authorization header with AWS4-HMAC-SHA256 signature, X-Amz-Content-Sha256 header with request body hash, and X-Amz-Date header with ISO8601 timestamp. Region: me-central-1, Service: execute-api. Additionally, all requests require x-unit-id and x-user-id headers."},"servers":[{"url":"https://auth-{env}-ae.roomi-services.com","description":"Live server"},{"url":"http://localhost:3000","description":"Local development server"}],"tags":[{"name":"Authentication","description":"OTP and UAE Pass authentication endpoints"},{"name":"User Management","description":"User CRUD and management operations"},{"name":"Onboarding","description":"User onboarding and unit management"}],"paths":{"/api/health":{"get":{"tags":["Health"],"summary":"Health check","description":"Check if the server is running","responses":{"200":{"description":"OK"}},"x-mint":{"metadata":{"title":"Health check","description":"Check if the server is running"}}}},"/api/send-otp":{"post":{"tags":["Authentication"],"summary":"Send OTP to phone number","description":"Send OTP to user phone number or unit admin phone","responses":{"200":{"description":"OTP sent successfully","content":{"application/json":{"schema":{"type":"object","properties":{"message":{"type":"string","example":"OTP sent successfully"},"phone":{"type":"string","example":"+971501234567"},"pinId":{"type":"string","example":"pin-123"}}}}}},"400":{"description":"Bad request","content":{"application/json":{"schema":{"type":"object","properties":{"error":{"type":"string","example":"Error message"}}}}}},"404":{"description":"User not found","content":{"application/json":{"schema":{"type":"object","properties":{"error":{"type":"string","example":"User not found"}}}}}}},"requestBody":{"required":true,"content":{"application/json":{"schema":{"type":"object","properties":{"phone":{"type":"string","description":"Phone number (minimum 10 digits)","example":"+971501234567"},"unit_id":{"type":"string","description":"Unit ID for admin users","example":"unit-123"}}}}}},"x-mint":{"metadata":{"title":"Send OTP to phone number","description":"Send OTP to user phone number or unit admin phone"}}}},"/api/resend-otp":{"post":{"tags":["Authentication"],"summary":"Resend OTP","description":"Resend OTP using pin ID","responses":{"200":{"description":"OTP resent successfully","content":{"application/json":{"schema":{"type":"object","properties":{"message":{"type":"string","example":"OTP resent successfully"}}}}}}},"requestBody":{"required":true,"content":{"application/json":{"schema":{"type":"object","properties":{"pin":{"type":"string","description":"PIN ID from previous OTP request","example":"pin-123"}}}}}},"x-mint":{"metadata":{"title":"Resend OTP","description":"Resend OTP using pin ID"}}}},"/api/validate-otp":{"post":{"tags":["Authentication"],"summary":"Validate OTP","description":"Validate OTP and authenticate user","responses":{"200":{"description":"OTP validated successfully","content":{"application/json":{"schema":{"type":"object","properties":{"token":{"type":"string","example":"jwt-token-here"},"user":{"type":"object","properties":{"user_id":{"type":"string","example":"user-123"},"phone":{"type":"string","example":"+971501234567"},"is_registered":{"type":"boolean","example":true}}}}}}}},"400":{"description":"Invalid OTP","content":{"application/json":{"schema":{"type":"object","properties":{"error":{"type":"string","example":"Invalid OTP"}}}}}}},"requestBody":{"required":true,"content":{"application/json":{"schema":{"type":"object","required":["phone","otp"],"properties":{"phone":{"type":"string","description":"Phone number","example":"+971501234567"},"otp":{"type":"string","description":"OTP code (6 digits)","example":"123456"},"pin":{"type":"string","description":"PIN ID from send OTP response","example":"pin-123"}}}}}},"x-mint":{"metadata":{"title":"Validate OTP","description":"Validate OTP and authenticate user"}}}},"/api/user/{user_id}/devices":{"get":{"tags":["User Management"],"summary":"Get user devices","description":"Get all devices for a specific user","parameters":[{"name":"user_id","in":"path","required":true,"schema":{"type":"string"}}],"responses":{"200":{"description":"User devices retrieved successfully","content":{"application/json":{"schema":{"type":"array","items":{"type":"object"}}}}},"404":{"description":"User not found","content":{"application/json":{"schema":{"type":"object","properties":{"error":{"type":"string","example":"User not found"}}}}}}},"x-mint":{"metadata":{"title":"Get user devices","description":"Get all devices for a specific user"}}}},"/api/uaepass/login":{"post":{"tags":["Authentication"],"summary":"UAE Pass login","description":"Authenticate user using UAE Pass","responses":{"200":{"description":"UAE Pass login successful","content":{"application/json":{"schema":{"type":"object","properties":{"token":{"type":"string","example":"jwt-token-here"},"user":{"type":"object","properties":{"user_id":{"type":"string","example":"user-123"},"phone":{"type":"string","example":"+971501234567"}}}}}}}},"400":{"description":"UAE Pass login failed","content":{"application/json":{"schema":{"type":"object","properties":{"error":{"type":"string","example":"UAE Pass login failed"}}}}}}},"requestBody":{"required":true,"content":{"application/json":{"schema":{"type":"object","properties":{"code":{"type":"string","description":"Authorization code from UAE Pass","example":"auth-code-123"},"state":{"type":"string","description":"State parameter","example":"state-123"}}}}}},"x-mint":{"metadata":{"title":"UAE Pass login","description":"Authenticate user using UAE Pass"}}}},"/api/generate-livekit-token":{"post":{"tags":["Authentication"],"summary":"Generate LiveKit token","description":"Generate LiveKit token for video/audio calling","responses":{"200":{"description":"LiveKit token generated successfully","content":{"application/json":{"schema":{"type":"object","properties":{"token":{"type":"string","example":"livekit-token-here"}}}}}}},"requestBody":{"required":true,"content":{"application/json":{"schema":{"type":"object","required":["roomName","participantName"],"properties":{"roomName":{"type":"string","description":"Room name for the meeting","example":"meeting-room-1"},"participantName":{"type":"string","description":"Participant display name","example":"John Doe"}}}}}},"x-mint":{"metadata":{"title":"Generate LiveKit token","description":"Generate LiveKit token for video/audio calling"}}}},"/api/me":{"get":{"tags":["User Management"],"summary":"Get current user","description":"Get current authenticated user information","responses":{"200":{"description":"User information retrieved successfully","content":{"application/json":{"schema":{"type":"object","properties":{"user_id":{"type":"string","example":"user-123"},"phone":{"type":"string","example":"+971501234567"},"is_registered":{"type":"boolean","example":true},"units":{"type":"array","items":{"type":"object","properties":{"unit_id":{"type":"string","example":"unit-123"},"access_type":{"type":"string","enum":["admin","user"],"example":"admin"}}}}}}}}},"401":{"description":"Unauthorized","content":{"application/json":{"schema":{"type":"object","properties":{"error":{"type":"string","example":"Unauthorized"}}}}}}},"requestBody":{"required":true,"content":{"application/json":{"schema":{"type":"object","properties":{"phone":{"type":"string","description":"Phone number (minimum 10 digits)","example":"+971501234567"},"unit_id":{"type":"string","description":"Unit ID for admin users","example":"unit-123"}}}}}},"x-mint":{"metadata":{"title":"Get current user","description":"Get current authenticated user information"}}}},"/api/user/{user_id}":{"get":{"tags":["User Management"],"summary":"Get user by ID","description":"Get user information by user ID","parameters":[{"name":"user_id","in":"path","required":true,"schema":{"type":"string"}}],"responses":{"200":{"description":"User information retrieved successfully","content":{"application/json":{"schema":{"type":"object","properties":{"user_id":{"type":"string","example":"user-123"},"phone":{"type":"string","example":"+971501234567"},"is_registered":{"type":"boolean","example":true}}}}}},"404":{"description":"User not found","content":{"application/json":{"schema":{"type":"object","properties":{"error":{"type":"string","example":"User not found"}}}}}}},"x-mint":{"metadata":{"title":"Get user by ID","description":"Get user information by user ID"}}},"delete":{"tags":["User Management"],"summary":"Delete user","description":"Delete user by user ID","parameters":[{"name":"user_id","in":"path","required":true,"schema":{"type":"string"}}],"responses":{"200":{"description":"User deleted successfully","content":{"application/json":{"schema":{"type":"object","properties":{"message":{"type":"string","example":"User deleted successfully"}}}}}},"404":{"description":"User not found","content":{"application/json":{"schema":{"type":"object","properties":{"error":{"type":"string","example":"User not found"}}}}}}},"x-mint":{"metadata":{"title":"Delete user","description":"Delete user by user ID"}}}},"/api/users/unit":{"get":{"tags":["User Management"],"summary":"Get users by unit","description":"Get all users belonging to a specific unit","responses":{"200":{"description":"Users retrieved successfully","content":{"application/json":{"schema":{"type":"array","items":{"type":"object","properties":{"user_id":{"type":"string"},"phone":{"type":"string"},"is_registered":{"type":"boolean"}}}}}}}},"requestBody":{"required":true,"content":{"application/json":{"schema":{"type":"object","properties":{"phone":{"type":"string","description":"Phone number (minimum 10 digits)","example":"+971501234567"},"unit_id":{"type":"string","description":"Unit ID for admin users","example":"unit-123"}}}}}},"x-mint":{"metadata":{"title":"Get users by unit","description":"Get all users belonging to a specific unit"}}}},"/api/user":{"post":{"tags":["User Management"],"summary":"Create new user","description":"Create a new user in the system","responses":{"201":{"description":"User created successfully","content":{"application/json":{"schema":{"type":"object","properties":{"user_id":{"type":"string","example":"user-123"},"phone":{"type":"string","example":"+971501234567"},"is_registered":{"type":"boolean","example":true}}}}}},"400":{"description":"Invalid user data","content":{"application/json":{"schema":{"type":"object","properties":{"error":{"type":"string","example":"Invalid user data"}}}}}}},"requestBody":{"required":true,"content":{"application/json":{"schema":{"type":"object","properties":{"user_id":{"type":"string","example":"user-123"},"phone":{"type":"string","example":"+971501234567"},"is_registered":{"type":"boolean","example":false}}}}}},"x-mint":{"metadata":{"title":"Create new user","description":"Create a new user in the system"}}},"put":{"tags":["User Management"],"summary":"Update user","description":"Update existing user information","responses":{"200":{"description":"User updated successfully","content":{"application/json":{"schema":{"type":"object","properties":{"user_id":{"type":"string","example":"user-123"},"phone":{"type":"string","example":"+971501234567"},"is_registered":{"type":"boolean","example":true}}}}}},"404":{"description":"User not found","content":{"application/json":{"schema":{"type":"object","properties":{"error":{"type":"string","example":"User not found"}}}}}}},"requestBody":{"required":true,"content":{"application/json":{"schema":{"type":"object","properties":{"user_id":{"type":"string","example":"user-123"},"phone":{"type":"string","example":"+971501234567"},"is_registered":{"type":"boolean","example":true}}}}}},"x-mint":{"metadata":{"title":"Update user","description":"Update existing user information"}}}},"/api/register":{"post":{"tags":["User Management"],"summary":"Register user","description":"Register user for the system","responses":{"200":{"description":"User registered successfully","content":{"application/json":{"schema":{"type":"object","properties":{"message":{"type":"string","example":"User registered successfully"}}}}}}},"requestBody":{"required":true,"content":{"application/json":{"schema":{"type":"object","properties":{"user_id":{"type":"string","example":"user-123"},"phone":{"type":"string","example":"+971501234567"}}}}}},"x-mint":{"metadata":{"title":"Register user","description":"Register user for the system"}}}},"/api/unregister":{"post":{"tags":["User Management"],"summary":"Unregister user","description":"Unregister user from the system","responses":{"200":{"description":"User unregistered successfully","content":{"application/json":{"schema":{"type":"object","properties":{"message":{"type":"string","example":"User unregistered successfully"}}}}}}},"requestBody":{"required":true,"content":{"application/json":{"schema":{"type":"object","properties":{"user_id":{"type":"string","example":"user-123"}}}}}},"x-mint":{"metadata":{"title":"Unregister user","description":"Unregister user from the system"}}}},"/api/user/devices":{"post":{"tags":["User Management"],"summary":"Add device to user subscription","description":"Add a device to user subscription for notifications","responses":{"200":{"description":"Device added successfully","content":{"application/json":{"schema":{"type":"object","properties":{"message":{"type":"string","example":"Device added successfully"}}}}}}},"requestBody":{"required":true,"content":{"application/json":{"schema":{"type":"object","properties":{"user_id":{"type":"string","example":"user-123"},"device_token":{"type":"string","example":"device-token-123"}}}}}},"x-mint":{"metadata":{"title":"Add device to user subscription","description":"Add a device to user subscription for notifications"}}}},"/api/onboarding/user-data":{"post":{"tags":["Onboarding"],"summary":"Fetch user data for onboarding","description":"Fetch user data by unit name for onboarding process","responses":{"200":{"description":"User data retrieved successfully","content":{"application/json":{"schema":{"type":"object","properties":{"success":{"type":"boolean","example":true},"data":{"type":"object","description":"User data for onboarding"}}}}}},"400":{"description":"Unit name is required","content":{"application/json":{"schema":{"type":"object","properties":{"error":{"type":"string","example":"Unit name is required"}}}}}},"500":{"description":"Failed to fetch user data","content":{"application/json":{"schema":{"type":"object","properties":{"error":{"type":"string","example":"Failed to fetch user data"}}}}}}},"requestBody":{"required":true,"content":{"application/json":{"schema":{"type":"object","required":["unitName"],"properties":{"unitName":{"type":"string","description":"Name of the unit","example":"Unit A-101"},"unit_id":{"type":"string","description":"Unit identifier","example":"unit-123"}}}}}},"x-mint":{"metadata":{"title":"Fetch user data for onboarding","description":"Fetch user data by unit name for onboarding process"}}}}},"components":{"securitySchemes":{"AWSSignatureV4":{"type":"apiKey","in":"header","name":"Authorization","description":"AWS Signature Version 4 authorization header (e.g., AWS4-HMAC-SHA256 Credential=...)"},"AWSContentSha256":{"type":"apiKey","in":"header","name":"X-Amz-Content-Sha256","description":"SHA256 hash of the request body"},"AWSDate":{"type":"apiKey","in":"header","name":"X-Amz-Date","description":"ISO8601 timestamp for the request (e.g., 20230101T120000Z)"}},"parameters":{"XUnitIdHeader":{"name":"x-unit-id","in":"header","description":"Unit identifier","required":true,"schema":{"type":"string"}},"XUserIdHeader":{"name":"x-user-id","in":"header","description":"User identifier","required":true,"schema":{"type":"string"}}}},"security":[{"AWSSignatureV4":[],"AWSContentSha256":[],"AWSDate":[]}]}